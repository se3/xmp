<?xml version='1.0' ?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/">

<bookmark> Flickr </bookmark>


<script>
titleArray  = null;
idArray     = null;
farmArray   = null;
serverArray = null;
secretArray = null;

loadXMLFile("http://api.flickr.com/services/rest/?method=flickr.interestingness.getList&amp;api_key=a145a8e29296de321e273148be64ec04");
itemSize = getXMLElementCount("rsp", "photos", "photo");
print("Item Size = ", itemSize);

count=0;
while(1){
  title  = getXMLAttribute("rsp", "photos", "photo", count, "title");
  id     = getXMLAttribute("rsp", "photos", "photo", count, "id");
  farm   = getXMLAttribute("rsp", "photos", "photo", count, "farm");
  server = getXMLAttribute("rsp", "photos", "photo", count, "server");
  secret = getXMLAttribute("rsp", "photos", "photo", count, "secret");

  print(count, ": " , id, farm, server, secret);

  titleArray  = pushBackStringArray(titleArray, title);
  idArray     = pushBackStringArray(idArray, id);
  serverArray = pushBackStringArray(serverArray, server);
  farmArray   = pushBackStringArray(farmArray, farm);
  secretArray = pushBackStringArray(secretArray, secret);

  count += 1;
  if (count == itemSize){
	break;
  }
}
print("titile array =", titleArray);

</script>

<item_template>
       <displayTitle>
            <script>
				getStringArrayAt(titleArray , -1);
			</script>
        </displayTitle>
        <media:thumbnail>
            <script>
				url = "http://" + "farm" + getStringArrayAt(farmArray , -1) + ".static.flickr.com/";
				url = url + getStringArrayAt(serverArray , -1) + "/";
				url = url + getStringArrayAt(idArray , -1) + "_";
				url = url + getStringArrayAt(secretArray , -1) + "_m.jpg";
				print(url);
				url;
			
			</script>
        </media:thumbnail>
        <playURL>
		   <script>
				url = "http://" + "farm" + getStringArrayAt(farmArray , -1) + ".static.flickr.com/";
				url = url + getStringArrayAt(serverArray , -1) + "/";
				url = url + getStringArrayAt(idArray , -1) + "_";
				url = url + getStringArrayAt(secretArray , -1) + ".jpg";
				print(url);
				url;				
           </script>
        </playURL>
		<media:content type="image/jpeg" />
		<onClick>
			print("onClick");
		</onClick>
</item_template>



<submenu name="Search Photos">
        <onClick>
            <script>
			keyword= getInput(); 
            if (keyword!=null) { 
              print("The search keyword is ", keyword);  	
			  url = "http://api.flickr.com/services/rest/?method=flickr.photos.search&amp;text=" + keyword + "&amp;per_page=48&amp;api_key=a145a8e29296de321e273148be64ec04";
			  	
			
			
			  titleArray  = null;
              idArray     = null;
              farmArray   = null;
              serverArray = null;
              secretArray = null;
              loadXMLFile(url);
              itemSize = getXMLElementCount("rsp", "photos", "photo");
              print("Item Size = ", itemSize);

              count=0;
              while(1){
                 title  = getXMLAttribute("rsp", "photos", "photo", count, "title");
                 id     = getXMLAttribute("rsp", "photos", "photo", count, "id");
                 farm   = getXMLAttribute("rsp", "photos", "photo", count, "farm");
                 server = getXMLAttribute("rsp", "photos", "photo", count, "server");
                 secret = getXMLAttribute("rsp", "photos", "photo", count, "secret");

                 print(count, ": " , id, farm, server, secret);

                 titleArray  = pushBackStringArray(titleArray, title);
                 idArray     = pushBackStringArray(idArray, id);
                 serverArray = pushBackStringArray(serverArray, server);
                 farmArray   = pushBackStringArray(farmArray, farm);
                 secretArray = pushBackStringArray(secretArray, secret);

                 count += 1;
                 if (count == itemSize){
	               break;
                 }
				 
              }
			  redrawDisplay();
           }
           else {
			  url = null;
		   }
			
            </script>
        </onClick>
</submenu>	


<channel>
	<title>Flickr</title>
	<link>./scripts_x/flickr.rss</link>
	<media:thumbnail url="http://static.youku.com/v1.0.0328/index/img/youkulogo.gif" width="120" height="90" />

<itemSize>
	<script>
		itemSize;
	</script>
</itemSize>

</channel>
</rss>
