<?xml version="1.0" ?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/">

    <script>
	  setRefreshTime(100);
	  urlArray_keep = null;
	  imageArray = null;
	  titleArray = null;
    </script>

    <onRefresh>

	   idArray = getItemInfoArray("locationID");
	   queryArray = getItemInfoArray("query");
	   setRefreshTime(-1);
	   urlArray = getItemInfoArray("link");
	   print(urlArray);
	   if (urlArray != urlArray_keep) {
	     i= 0;
	     titleArray = null;
	     imageArray = null;
	     print(urlArray_keep);
	     urlArray_keep = urlArray;
	     while ( getStringArrayAt(urlArray, i) != null ) {
	       loadXMLFile(getStringArrayAt(urlArray, i));
		   URL = getStringArrayAt(urlArray, i);
		   print("URL =", URL);
		   title= getXMLAttribute("rss", "channel", "yweather:location", "city");
		   condition =getXMLAttribute("rss", "channel", "item", "yweather:condition", "text");
		   temp = getXMLAttribute("rss", "channel", "item", "yweather:condition", "temp");
		   title = title + ": " + condition + " " + temp + "C";
		   print(title);
		   titleArray = pushBackStringArray(titleArray, title);
		   code = getXMLAttribute("rss", "channel", "item", "yweather:condition", "code");
		   image = "http://l.yimg.com/us.yimg.com/i/us/we/52/" + code + ".gif";
		   print(image);
		   imageArray = pushBackStringArray(imageArray, image);
		   i= i+1;
	     }
	   }
    </onRefresh>

    <onUpdate>setRefreshTime(100);</onUpdate>
    <item_template>
        <displayTitle>
            <script>getStringArrayAt(titleArray , -1);</script>
        </displayTitle>
        <media:thumbnail>
            <script>getStringArrayAt(imageArray , -1);</script>
        </media:thumbnail>
        <link>
            <script>id = getStringArrayAt(idArray , -1); "http://weather.yahooapis.com/forecastrss?p=" + id + "&amp;u=c";</script>
        </link>
        <forcast>
            <script> "http://api.wunderground.com/auto/wui/geo/ForecastXML/index.xml?query=" + getStringArrayAt(queryArray , -1);</script>
        </forcast>
        <mediaDisplay name="weatherView" />
        <zoom>city</zoom>
    </item_template>





    <submenu>
        <title>Asia/Europe</title>
        <link>>http://localhost/x_live/scripts/map/world.rss</link>
        <media:thumbnail url="image/search.jpg" width="120" height="90" />
        <mediaDisplay name=photoView"
		rowCount="8" columnCount="4"
		drawItemText="yes"
		sideColorBottom="20:20:20"
		sideColorTop="20:20:20"
		backgroundColor="0:0:0"
		sliding="no"
	/>
    </submenu>

    <submenu name="USA ZIP Code">
        <onClick>
            <script>
			keyword= getInput();
            if (keyword!=null) {
              print("The zip code is ", keyword);
			  url = "http://weather.yahooapis.com/forecastrss?p=" + keyword + "&amp;u=c";
			}
			else {
			  url = null;
			}

            </script>
        </onClick>
    </submenu>


    <channel>
        <title>World Weather Forecast Service</title>
        <link>http://localhost/x_live/scripts/map/myfavorites.rss</link>
        <media:thumbnail url="image/weather.jpg" />
        <!-- favorite element indicate this document will collect the links from its child documents when child element throw link to favorite list -->
        <!--favorite list="weather" /-->
    </channel>
</rss>
